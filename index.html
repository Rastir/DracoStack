<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>An√°lisis de Churn</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/styles.css">
</head>

<body>
    <div class="container">

        <!-- HEADER -->
        <header class="header">
            <div class="header-left">
                <img src="/img/logo.png" alt="Empresa" class="logo">
                <div class="header-text">
                    <h1>An√°lisis de Churn</h1>
                    <p>Predicci√≥n Inteligente de Cancelamiento de Clientes</p>
                </div>
            </div>
        </header>

        <!-- TABS -->
        <div class="tabs">
            <button class="tab-btn active" onclick="cambiarTab(this, 'manual')">
                C√°lculo Manual
            </button>
            <button class="tab-btn" onclick="cambiarTab(this, 'busqueda')">
                B√∫squeda
            </button>
            <button class="tab-btn" onclick="cambiarTab(this, 'stats')">
                An√°lisis Avanzado
            </button>
        </div>

        <!-- SECCI√ìN MANUAL -->
        <section class="seccion" id="manual">
            <div class="card-layout">
                <div class="grid-manual">

                    <!-- FORMULARIO -->
                    <div class="card">
                        <h2>üìä Datos del Cliente</h2>

                        <form id="churnForm">
                            <label for="age">Edad</label>
                            <input type="number" id="age" name="age" placeholder="Ej: 52" min="18" max="100" required>

                            <label for="gender">G√©nero</label>
                            <select id="gender" name="gender" required>
                                <option value="" disabled selected>Seleccionar...</option>
                                <option value="Male">Masculino</option>
                                <option value="Female">Femenino</option>
                            </select>

                            <label for="subscription_type">Tipo de Suscripci√≥n</label>
                            <select id="subscription_type" name="subscription_type" required>
                                <option value="" disabled selected>Seleccionar...</option>
                                <option value="Basic">Basic</option>
                                <option value="Standard">Standard</option>
                                <option value="Premium">Premium</option>
                            </select>

                            <label for="watch_hours">Horas de Visualizaci√≥n</label>
                            <input type="number" step="0.1" id="watch_hours" name="watch_hours" placeholder="Ej: 1.1"
                                min="0" required>

                            <label for="region">Regi√≥n</label>
                            <select id="region" name="region" required>
                                <option value="" disabled selected>Seleccionar...</option>
                                <option value="Africa">√Åfrica</option>
                                <option value="Europe">Europa</option>
                                <option value="Asia">Asia</option>
                                <option value="Oceania">Ocean√≠a</option>
                                <option value="South America">Sudam√©rica</option>
                                <option value="North America">Am√©rica del Norte</option>
                            </select>

                            <label for="number_of_profiles">N√∫mero de perfiles</label>
                            <input type="number" id="number_of_profiles" name="number_of_profiles" placeholder="Ej: 3"
                                min="1" required>

                            <label for="payment_method">M√©todo de pago</label>
                            <select id="payment_method" name="payment_method" required>
                                <option value="" disabled selected>Seleccionar...</option>
                                <option value="debit card">Tarjeta de d√©bito</option>
                                <option value="paypal">PayPal</option>
                                <option value="crypto">Criptomonedas</option>
                                <option value="gift card">Tarjeta de regalo</option>
                                <option value="credit card">Tarjeta de cr√©dito</option>
                            </select>

                            <label for="device">Dispositivo</label>
                            <select id="device" name="device" required>
                                <option value="" disabled selected>Seleccionar...</option>
                                <option value="tablet">Tablet</option>
                                <option value="laptop">Laptop</option>
                                <option value="mobile">Celular</option>
                                <option value="tv">Televisi√≥n</option>
                                <option value="desktop">Computador de escritorio</option>
                            </select>

                            <button type="submit">ANALIZAR CLIENTE</button>
                        </form>

                        <div id="resultado" class="resultado hidden"></div>
                    </div>

                    <!-- API PREVIEW -->
                    <div class="card">
                        <h2>üì° Vista Previa de la API</h2>
                        <pre id="apiPreview" class="api-box"></pre>
                    </div>

                </div>
            </div>
        </section>

        <!-- SECCI√ìN B√öSQUEDA -->
        <section class="seccion hidden" id="busqueda">
            <div class="card-layout">
                <div class="card search-container">
                    <h2>üîç B√∫squeda de Cliente</h2>

                    <label for="clientId">ID del Cliente</label>
                    <input type="text" id="clientId" placeholder="Ej: CUS-6BF81F27">

                    <button onclick="buscarCliente()">BUSCAR CLIENTE</button>

                    <div id="resultadoBusqueda" class="resultado hidden"></div>
                </div>
            </div>
        </section>

        <!-- SECCI√ìN ESTAD√çSTICAS -->
        <section class="seccion hidden" id="stats">
            <div class="card">
                <div class="stats-header">
                    <h2 style="text-align: center; color: #00c6ff; margin:0; padding:0;">üìà An√°lisis Avanzado</h2>
                    <!-- Bot√≥n exportar PDF en esquina superior derecha -->
                    <button id="exportPdfBtn" class="export-btn" onclick="exportChartsToPDF()">Exportar a PDF</button>
                </div>

                <div class="stats-grid">
                    <div class="chart-card">
                        <canvas id="chartRiesgo"></canvas>
                    </div>
                    <div class="chart-card">
                        <canvas id="chartSubscription"></canvas>
                    </div>
                    <div class="chart-card">
                        <canvas id="chartRegion"></canvas>
                    </div>
                    <div class="chart-card">
                        <canvas id="chartAge"></canvas>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- jsPDF UMD -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="/js/app.js"></script>
</body>

</html>